#!/usr/bin/env perl
# A perl script to replace the string QQQ with the bit pattern
# appropriate for the angle found in the string immediately
# before the QQQ string.

use strict;
use warnings;

my $name = $0; $name =~ s'.*/''; # remove path--like basename
my $usage = "usage:\n$name [-opt1] [-opt2] [-opt3]";
my $bitstrings;
my $debug = 0;

while (<DATA>) {
  my $angle;
  my $bits;
  next if (/^\s*$|^\s*#/); # skip white, blank and commented lines.
  chomp;
  ($angle, $bits) = ( $_ =~ m/(\d+)\s(\d+)/ );
  $bitstrings->[$angle] = $bits;
}

if ($debug) {
  for (my($var)=$[; $var<=$#{$bitstrings}; $var++) {
    print "$var: $bitstrings->[$var]\n";
  }
}

while (<>) {
  # print $_;
  # if ( $_ =~ m/(\d{1,3})° \|\| \{\{mono\|QQQ\}\}/  ) {
  #   print ">$1<\n";
  # }
  $_ =~ s/(\d{1,3})° \|\| \{\{mono\|QQQ\}\}/sprintf("%d° || {{mono||%s}}",$1,$bitstrings->[$1])/eg;
  print $_;
}

exit 0;

# |   0° || {{mono||100000001}} ||   1° || {{mono||110000001}} ||   2° || {{mono||111000001}} ||   3° || {{mono||111000011}} ||   4° || {{mono||111000111}} ||   5° || {{mono||111001111}} ||   6° || {{mono||111011111}} ||   7° || {{mono||111011011}} ||   8° || {{mono||101011011}}
# |   0° || {{mono|QQQ}} ||   1° || {{mono|QQQ}} ||   2° || {{mono|QQQ}} ||   3° || {{mono|QQQ}} ||   4° || {{mono|QQQ}} ||   5° || {{mono|QQQ}} ||   6° || {{mono|QQQ}} ||   7° || {{mono|QQQ}} ||   8° || {{mono|QQQ}}

__END__
 000 100000001
 001 110000001
 002 111000001
 003 111000011
 004 111000111
 005 111001111
 006 111011111
 007 111011011
 008 101011011
 009 101011111
 010 101011101
 011 101010101
 012 101010111
 013 101110111
 014 001110111
 015 001010111
 016 001011111
 017 001011011
 018 001011001
 019 001111001
 020 001111101
 021 000111101
 022 000110101
 023 000100101
 024 000101101
 025 000101001
 026 000111001
 027 000110001
 028 000010001
 029 000011001
 030 000001001
 031 100001001
 032 100001101
 033 100000101
 034 110000101
 035 010000101
 036 010000111
 037 010000011
 038 010000001
 039 000000001
 040 000000011
 041 100000011
 042 110000011
 043 110000111
 044 110001111
 045 110011111
 046 110111111
 047 110110111
 048 010110111
 049 010111111
 050 010111011
 051 010101011
 052 010101111
 053 011101111
 054 011101110
 055 010101110
 056 010111110
 057 010110110
 058 010110010
 059 011110010
 060 011111010
 061 001111010
 062 001101010
 063 001001010
 064 001011010
 065 001010010
 066 001110010
 067 001100010
 068 000100010
 069 000110010
 070 000010010
 071 000010011
 072 000011011
 073 000001011
 074 100001011
 075 100001010
 076 100001110
 077 100000110
 078 100000010
 079 000000010
 080 000000110
 081 000000111
 082 100000111
 083 100001111
 084 100011111
 085 100111111
 086 101111111
 087 101101111
 088 101101110
 089 101111110
 090 101110110
 091 101010110
 092 101011110
 093 111011110
 094 111011100
 095 101011100
 096 101111100
 097 101101100
 098 101100100
 099 111100100
 100 111110100
 101 011110100
 102 011010100
 103 010010100
 104 010110100
 105 010100100
 106 011100100
 107 011000100
 108 001000100
 109 001100100
 110 000100100
 111 000100110
 112 000110110
 113 000010110
 114 000010111
 115 000010101
 116 000011101
 117 000001101
 118 000000101
 119 000000100
 120 000001100
 121 000001110
 122 000001111
 123 000011111
 124 000111111
 125 001111111
 126 011111111
 127 011011111
 128 011011101
 129 011111101
 130 011101101
 131 010101101
 132 010111101
 133 110111101
 134 110111001
 135 010111001
 136 011111001
 137 011011001
 138 011001001
 139 111001001
 140 111101001
 141 111101000
 142 110101000
 143 100101000
 144 101101000
 145 101001000
 146 111001000
 147 110001000
 148 010001000
 149 011001000
 150 001001000
 151 001001100
 152 001101100
 153 000101100
 154 000101110
 155 000101010
 156 000111010
 157 000011010
 158 000001010
 159 000001000
 160 000011000
 161 000011100
 162 000011110
 163 000111110
 164 001111110
 165 011111110
 166 111111110
 167 110111110
 168 110111010
 169 111111010
 170 111011010
 171 101011010
 172 101111010
 173 101111011
 174 101110011
 175 101110010
 176 111110010
 177 110110010
 178 110010010
 179 110010011
 180 111010011
 181 111010001
 182 101010001
 183 001010001
 184 011010001
 185 010010001
 186 110010001
 187 100010001
 188 100010000
 189 110010000
 190 010010000
 191 010011000
 192 011011000
 193 001011000
 194 001011100
 195 001010100
 196 001110100
 197 000110100
 198 000010100
 199 000010000
 200 000110000
 201 000111000
 202 000111100
 203 001111100
 204 011111100
 205 111111100
 206 111111101
 207 101111101
 208 101110101
 209 111110101
 210 110110101
 211 010110101
 212 011110101
 213 011110111
 214 011100111
 215 011100101
 216 111100101
 217 101100101
 218 100100101
 219 100100111
 220 110100111
 221 110100011
 222 010100011
 223 010100010
 224 110100010
 225 100100010
 226 100100011
 227 000100011
 228 000100001
 229 100100001
 230 100100000
 231 100110000
 232 110110000
 233 010110000
 234 010111000
 235 010101000
 236 011101000
 237 001101000
 238 000101000
 239 000100000
 240 001100000
 241 001110000
 242 001111000
 243 011111000
 244 111111000
 245 111111001
 246 111111011
 247 011111011
 248 011101011
 249 111101011
 250 101101011
 251 101101010
 252 111101010
 253 111101110
 254 111001110
 255 111001010
 256 111001011
 257 011001011
 258 001001011
 259 001001111
 260 101001111
 261 101000111
 262 101000110
 263 101000100
 264 101000101
 265 001000101
 266 001000111
 267 001000110
 268 001000010
 269 001000011
 270 001000001
 271 001100001
 272 101100001
 273 101100000
 274 101110000
 275 101010000
 276 111010000
 277 011010000
 278 001010000
 279 001000000
 280 011000000
 281 011100000
 282 011110000
 283 111110000
 284 111110001
 285 111110011
 286 111110111
 287 111110110
 288 111010110
 289 111010111
 290 011010111
 291 011010101
 292 111010101
 293 111011101
 294 110011101
 295 110010101
 296 110010111
 297 110010110
 298 010010110
 299 010011110
 300 010011111
 301 010001111
 302 010001101
 303 010001001
 304 010001011
 305 010001010
 306 010001110
 307 010001100
 308 010000100
 309 010000110
 310 010000010
 311 011000010
 312 011000011
 313 011000001
 314 011100001
 315 010100001
 316 110100001
 317 110100000
 318 010100000
 319 010000000
 320 110000000
 321 111000000
 322 111100000
 323 111100001
 324 111100011
 325 111100111
 326 111101111
 327 111101101
 328 110101101
 329 110101111
 330 110101110
 331 110101010
 332 110101011
 333 110111011
 334 100111011
 335 100101011
 336 100101111
 337 100101101
 338 100101100
 339 100111100
 340 100111110
 341 100011110
 342 100011010
 343 100010010
 344 100010110
 345 100010100
 346 100011100
 347 100011000
 348 100001000
 349 100001100
 350 100000100
 351 110000100
 352 110000110
 353 110000010
 354 111000010
 355 101000010
 356 101000011
 357 101000001
 358 101000000
 359 100000000
